#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Auto-fix ESLint errors on commit (AGGRESSIVE MODE)
echo "ðŸ”§ Running ESLint auto-fix on staged files..."

# Get list of staged JS/JSX files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(js|jsx)$' || true)

if [ -n "$STAGED_FILES" ]; then
  echo "Files to fix: $STAGED_FILES"

  # Run ESLint with --fix on each staged file
  for FILE in $STAGED_FILES; do
    echo "  â†’ Fixing $FILE"
    npx eslint "$FILE" --fix --quiet 2>/dev/null || true

    # Re-stage the file if it was modified
    git add "$FILE"
  done

  echo "âœ… ESLint auto-fix complete"
else
  echo "No JS/JSX files to check"
fi

exit 0
